# Consistent Hashing: Complete Visual Guide

## The Problem with Traditional Hashing

### Visual 1: Traditional Hashing Works Fine... Until You Scale

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TRADITIONAL HASHING                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“¦ Package A (ID_X) â†’ Hash(12) â†’ 12 mod 5 = 2 â†’ ğŸšš S2     â”‚
â”‚  ğŸ“¦ Package B (ID_Y) â†’ Hash(15) â†’ 15 mod 5 = 0 â†’ ğŸšš S0     â”‚
â”‚  ğŸ“¦ Package C (ID_Z) â†’ Hash(13) â†’ 13 mod 5 = 3 â†’ ğŸšš S3     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚                   â”‚
â”‚  â”‚     â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚                   â”‚
â”‚  â”‚ ğŸ“¦B â”‚ â”‚     â”‚ â”‚ ğŸ“¦A â”‚ â”‚ ğŸ“¦C â”‚ â”‚     â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual 2: Adding a Server Causes Chaos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEFORE: 5 SERVERS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚                   â”‚
â”‚  â”‚ ğŸ“¦B â”‚ â”‚     â”‚ â”‚ ğŸ“¦A â”‚ â”‚ ğŸ“¦C â”‚ â”‚     â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AFTER: 6 SERVERS (CHAOS!)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚ â”‚ S5  â”‚           â”‚
â”‚  â”‚ğŸ“¦A,Bâ”‚ â”‚ ğŸ“¦C â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚ â”‚     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  âŒ MASSIVE RESHUFFLING: 80% of packages moved!             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## The Solution: Consistent Hashing Hash Ring

### Visual 3: The Hash Ring Concept

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual 4: Servers Placed on the Ring

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ğŸšš S0 (100)    ğŸšš S1 (250)    ğŸšš S2 (400)    ğŸšš S3 (700)    ğŸšš S4 (950)
```

### Visual 5: Packages and Servers on the Ring

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¦D(50) ğŸššS0(100) ğŸ“¦A(120) ğŸššS1(250) ğŸ“¦B(300) ğŸššS2(400) ğŸššS3(700) ğŸ“¦C(800) ğŸššS4(950)
    â†‘           â†‘         â†‘           â†‘         â†‘           â†‘                    â†‘           â†‘
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Package D â†’ S0      Package A â†’ S1      Package B â†’ S2                    Package C â†’ S4
```

## Adding a Server: Minimal Disruption

### Visual 6: Adding S5 to the Ring

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¦D(50) ğŸššS0(100) ğŸ“¦A(120) ğŸššS1(250) ğŸ“¦B(300) ğŸššS5(350) ğŸššS2(400) ğŸššS3(700) ğŸ“¦C(800) ğŸššS4(950)
    â†‘           â†‘         â†‘           â†‘         â†‘           â†‘           â†‘                    â†‘           â†‘
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Package D â†’ S0      Package A â†’ S1      Package B â†’ S5           Package C â†’ S4
```

### Visual 7: Before vs After Adding S5

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEFORE: 5 SERVERS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦D â†’ S0    ğŸ“¦A â†’ S1    ğŸ“¦B â†’ S2    ğŸ“¦C â†’ S4              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚                   â”‚
â”‚  â”‚ ğŸ“¦D â”‚ â”‚ ğŸ“¦A â”‚ â”‚ ğŸ“¦B â”‚ â”‚     â”‚ â”‚ ğŸ“¦C â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AFTER: 6 SERVERS (MINIMAL DISRUPTION!)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦D â†’ S0    ğŸ“¦A â†’ S1    ğŸ“¦B â†’ S5    ğŸ“¦C â†’ S4              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚ â”‚ S5  â”‚           â”‚
â”‚  â”‚ ğŸ“¦D â”‚ â”‚ ğŸ“¦A â”‚ â”‚     â”‚ â”‚     â”‚ â”‚ ğŸ“¦C â”‚ â”‚ ğŸ“¦B â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  âœ… ONLY 1 PACKAGE MOVED (20% vs 80% in traditional!)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Removing a Server: Graceful Degradation

### Visual 8: Removing S4 from the Ring

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¦D(50) ğŸššS0(100) ğŸ“¦A(120) ğŸššS1(250) ğŸ“¦B(300) ğŸššS2(400) ğŸššS3(700) ğŸ“¦C(800)
    â†‘           â†‘         â†‘           â†‘         â†‘           â†‘                    â†‘
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   Package D â†’ S0      Package A â†’ S1      Package B â†’ S2                    Package C â†’ S0
```

### Visual 9: Before vs After Removing S4

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BEFORE: 5 SERVERS                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦D â†’ S0    ğŸ“¦A â†’ S1    ğŸ“¦B â†’ S2    ğŸ“¦C â†’ S4              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚ â”‚ S4  â”‚                   â”‚
â”‚  â”‚ ğŸ“¦D â”‚ â”‚ ğŸ“¦A â”‚ â”‚ ğŸ“¦B â”‚ â”‚     â”‚ â”‚ ğŸ“¦C â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AFTER: 4 SERVERS (S4 FAILED!)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¦D â†’ S0    ğŸ“¦A â†’ S1    ğŸ“¦B â†’ S2    ğŸ“¦C â†’ S0              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ S0  â”‚ â”‚ S1  â”‚ â”‚ S2  â”‚ â”‚ S3  â”‚                           â”‚
â”‚  â”‚ğŸ“¦D,Câ”‚ â”‚ ğŸ“¦A â”‚ â”‚ ğŸ“¦B â”‚ â”‚     â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                             â”‚
â”‚  âœ… ONLY 1 PACKAGE MOVED (20% vs 80% in traditional!)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Virtual Nodes: Solving Distribution Problems

### Visual 10: Problem with Basic Consistent Hashing

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸššP1(10)                    ğŸššP2(50)                    ğŸššP3(90)
    â†‘                           â†‘                           â†‘
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   HUGE SEGMENT (80% of ring)                           SMALL SEGMENT (20% of ring)
   P1 gets overloaded!                                  P2, P3 underutilized!
```

### Visual 11: Virtual Nodes Solution

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â•±                                 â•²
                  â•±                                   â•²
                 â•±                                     â•²
                â•±                                       â•²
               â•±                                         â•²
              â•±                                           â•²
             â•±                                             â•²
            â•±                                               â•²
           â•±                                                 â•²
          â•±                                                   â•²
         â•±                                                     â•²
        â•±                                                       â•²
       â•±                                                         â•²
      â•±                                                           â•²
     â•±                                                             â•²
    â•±                                                               â•²
   â•±                                                                 â•²
  â•±                                                                   â•²
 â•±                                                                     â•²
â•±                                                                       â•²
â•²                                                                       â•±
 â•²                                                                     â•±
  â•²                                                                   â•±
   â•²                                                                 â•±
    â•²                                                               â•±
     â•²                                                             â•±
      â•²                                                           â•±
       â•²                                                         â•±
        â•²                                                       â•±
         â•²                                                     â•±
          â•²                                                   â•±
           â•²                                                 â•±
            â•²                                               â•±
             â•²                                             â•±
              â•²                                           â•±
               â•²                                         â•±
                â•²                                       â•±
                 â•²                                     â•±
                  â•²                                   â•±
                   â•²                                 â•±
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”µP1a(10) ğŸ”´P3a(30) ğŸ”µP1b(45) ğŸ”´P2a(50) ğŸ”µP1c(65) ğŸ”´P2b(80) ğŸ”µP1d(85) ğŸ”´P3b(90)
ğŸ”µ = P-Truck-1 Virtual Nodes    ğŸ”´ = P-Truck-2 Virtual Nodes    ğŸ”µ = P-Truck-3 Virtual Nodes
```

### Visual 12: Load Distribution Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BASIC CONSISTENT HASHING                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   P-Truck-1 â”‚ â”‚   P-Truck-2 â”‚ â”‚   P-Truck-3 â”‚           â”‚
â”‚  â”‚   (80% load)â”‚ â”‚   (10% load)â”‚ â”‚   (10% load)â”‚           â”‚
â”‚  â”‚   ğŸ”¥ HOT!   â”‚ â”‚             â”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WITH VIRTUAL NODES                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   P-Truck-1 â”‚ â”‚   P-Truck-2 â”‚ â”‚   P-Truck-3 â”‚           â”‚
â”‚  â”‚   (33% load)â”‚ â”‚   (33% load)â”‚ â”‚   (34% load)â”‚           â”‚
â”‚  â”‚   âœ… BALANCEDâ”‚ â”‚   âœ… BALANCEDâ”‚ â”‚   âœ… BALANCEDâ”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual 13: Fault Tolerance with Virtual Nodes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    P-TRUCK-1 FAILS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”µP1a(10) ğŸ”´P3a(30) ğŸ”µP1b(45) ğŸ”´P2a(50) ğŸ”µP1c(65) ğŸ”´P2b(80) ğŸ”µP1d(85) ğŸ”´P3b(90) â”‚
â”‚     â†“           â†‘         â†“           â†‘         â†“           â†‘         â†“           â†‘ â”‚
â”‚  ğŸ”´P3a takes  ğŸ”´P2a takes  ğŸ”´P2b takes  ğŸ”´P3b takes  â”‚
â”‚  packages     packages     packages     packages     â”‚
â”‚  from P1a     from P1b     from P1c     from P1d     â”‚
â”‚                                                             â”‚
â”‚  âœ… LOAD DISTRIBUTED ACROSS ALL SURVIVING TRUCKS!           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Summary: Why Consistent Hashing is Revolutionary

### Visual 14: Traditional vs Consistent Hashing Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TRADITIONAL HASHING                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âŒ Adding 1 server â†’ 80% of data moves                     â”‚
â”‚  âŒ Removing 1 server â†’ 80% of data moves                   â”‚
â”‚  âŒ Massive reshuffling on every change                     â”‚
â”‚  âŒ Poor scalability                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CONSISTENT HASHING                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Adding 1 server â†’ Only k/n keys move (k=total, n=nodes) â”‚
â”‚  âœ… Removing 1 server â†’ Only affected keys move             â”‚
â”‚  âœ… Minimal disruption on changes                           â”‚
â”‚  âœ… Excellent scalability                                   â”‚
â”‚  âœ… Virtual nodes for perfect load balancing                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

This is why Consistent Hashing is fundamental to distributed systems like:
- **Amazon DynamoDB**
- **Apache Cassandra** 
- **ScyllaDB**
- **Redis Cluster**
- **Load balancers**
- **CDN systems**

The hash ring with virtual nodes provides the perfect balance of scalability, fault tolerance, and load distribution that modern distributed systems require.
